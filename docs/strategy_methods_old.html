<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Strategy Methods - Lumibot documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Lumibot  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Lumibot  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="lifecycle_methods.html">Lifecycle Methods</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="strategy_methods.html">Strategy Methods</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="strategy_methods.orders.html">Order Management</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.create_order.html">self.create_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.submit_order.html">self.submit_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.submit_orders.html">self.submit_orders</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.cancel_order.html">self.cancel_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.cancel_orders.html">self.cancel_orders</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.cancel_open_orders.html">self.cancel_open_orders</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.sell_all.html">self.sell_all</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.get_tracked_order.html">self.get_tracked_order</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.get_tracked_orders.html">self.get_tracked_orders</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.get_tracked_position.html">self.get_tracked_position</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.get_tracked_positions.html">self.get_tracked_positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.orders/strategies.strategy.Strategy.get_asset_potential_total.html">self.get_asset_potential_total</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="strategy_methods.data.html">Data</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_last_price.html">self.get_last_price</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_last_prices.html">self.get_last_prices</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_tradable_assets.html">self.get_tradable_assets</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_symbol_bars.html">self.get_symbol_bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_bars.html">self.get_bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.start_realtime_bars.html">self.start_realtime_bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_realtime_bars.html">self.get_realtime_bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.cancel_realtime_bars.html">self.cancel_realtime_bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_yesterday_dividend.html">self.get_yesterday_dividend</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.data/strategies.strategy.Strategy.get_yesterday_dividends.html">self.get_yesterday_dividends</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="strategy_methods.options.html">Options</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.options/strategies.strategy.Strategy.get_chain.html">self.get_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.options/strategies.strategy.Strategy.get_chains.html">self.get_chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.options/strategies.strategy.Strategy.get_greeks.html">self.get_greeks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="strategy_methods.datetime.html">DateTime</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_datetime.html">self.get_datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_timestamp.html">self.get_timestamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_round_minute.html">self.get_round_minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_last_minute.html">self.get_last_minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_round_day.html">self.get_round_day</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_last_day.html">self.get_last_day</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.get_datetime_range.html">self.get_datetime_range</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.localize_datetime.html">self.localize_datetime</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.datetime/strategies.strategy.Strategy.to_default_timezone.html">self.to_default_timezone</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="strategy_methods.misc.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.log_message.html">self.log_message</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.sleep.html">self.sleep</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.await_market_to_close.html">self.await_market_to_close</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.await_market_to_open.html">self.await_market_to_open</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.wait_for_order_registration.html">self.wait_for_order_registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.wait_for_order_execution.html">self.wait_for_order_execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.wait_for_orders_registration.html">self.wait_for_orders_registration</a></li>
<li class="toctree-l3"><a class="reference internal" href="strategy_methods.misc/strategies.strategy.Strategy.wait_for_orders_execution.html">self.wait_for_orders_execution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="strategy_properties.html">Strategy Properties</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="backtesting.html">Backtesting</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="backtesting.yahoo.html">Yahoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="backtesting.pandas.html">Pandas (CSV or other data)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="brokers.html">Brokers</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="brokers.alpaca.html">Alpaca</a></li>
<li class="toctree-l2"><a class="reference internal" href="brokers.interactive_brokers.html">Interactive Brokers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="entities.html">Entities</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="entities.asset.html">Asset</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities.bar.html">Bar</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities.bars.html">Bars</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities.data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities.dataline.html">Dataline</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities.order.html">Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities.position.html">Position</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="strategy-methods">
<h1>Strategy Methods<a class="headerlink" href="#strategy-methods" title="Permalink to this headline">¶</a></h1>
<p>All user defined strategies should inherit from the Strategy class.</p>
<p>from strategies import Strategy</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">Strategy</span><span class="p">):</span>
   <span class="k">pass</span>
</pre></div>
</div>
<p>The abstract class Strategy has global parameters with default values, and some properties that can be used as helpers to build trading logic.</p>
<p>The methods of this class can be split into several categories:</p>
<p><strong>Lifecycle Methods</strong> These are executed at different times during the execution of the bot. These represent the main flow of a strategy, some are mandatory.</p>
<p><strong>Strategy Methods</strong> These are strategy helper methods.</p>
<p><strong>Broker Methods</strong> How to interact with the broker (buy, sell, get positions, etc)</p>
<p><strong>Data Methods</strong> How to get price data easily</p>
<p>All the methods in each of these categories are described below.</p>
<p>When a strategy is instantiated, a broker object is passed to it (Check Quickstart). The strategy is run with the passed broker object. The following shortcuts executes broker methods within the strategy. Some methods can use either a symbol or an asset object. Please see asset.</p>
<div class="toctree-wrapper compound">
</div>
<p><strong>self.log_message()</strong></p>
<p>Logs an info message prefixed with the strategy</p>
<p><strong>self.sleep()</strong></p>
<p>Sleeps for sleeptime seconds. The way that sleep should be used within a strategy. Using the regular Python sleep() method will throw an error.</p>
<p>Parameters:</p>
<p>sleeptime (float): The sleep duration in seconds</p>
<p><strong>self.await_market_to_open()</strong></p>
<p>If the market is closed, pauses code execution until self.minutes_before_opening minutes before market opens again. If an input (float) is passed as parameter, pauses code execution until input minutes before market opens again.</p>
<p>Parameters:</p>
<p>timedelta (float): Duration in minutes
Return type: None</p>
<p><strong>self.await_market_to_close()</strong></p>
<p>If the market is open, pauses code execution until self.minutes_before_closing minutes before market closes. If an input (float) is passed as parameter, pauses code execution until input minutes before market closes again.</p>
<p>Parameters:</p>
<p>timedelta (float): Duration in minutes
Return type: None</p>
<p><strong>self.get_tracked_position()</strong></p>
<p>Return the strategy tracked position for a given symbol if found else None.</p>
<p>Parameters:</p>
<p>symbol (str): The share/asset string representation (e.g AAPL, GOOG, …)
Return type: position</p>
<p><strong>self.get_tracked_positions()</strong></p>
<p>Return all the strategy tracked positions.</p>
<p>Return type: list(position)</p>
<p><strong>self.get_tracked_order()</strong></p>
<p>Return the strategy tracked order with the specified identifier if found else None.</p>
<p>Parameters:</p>
<p>identifier (str): The broker order identifier
Return type: order</p>
<p><strong>self.get_tracked_orders()</strong></p>
<p>Return all the strategy tracked orders.</p>
<p>Return type: list(order)</p>
<p><strong>self.get_tracked_assets()</strong></p>
<p>Return the strategy list of symbols for all tracked positions and orders.</p>
<p>Return type: list(str/asset)</p>
<p><strong>self.get_asset_potential_total()</strong></p>
<p>Check the ongoing positions and the tracked orders of the strategy and returns the total number of shares provided all orders went through. In other words, add all outstanding orders and the total value of the position for an asset.</p>
<p>For example, if you own 100 SPY and have an outstanding limit order of 10 shares, we will count all 110 shares.</p>
<p>Parameters:</p>
<p>symbol (str/asset): the string representation of the share/asset
Return type: int</p>
<p><strong>self.create_order()</strong></p>
<p>Create an order object attached to this strategy (Check the Entities, order section)</p>
<p>Required Parameters:</p>
<p>symbol (str/asset): representation of the asset to buy
quantity (int): the quantity of the asset to buy
side (str): either “buy” or “sell”
Optional Parameters:</p>
<p>limit_price (default = None)
stop_price (default = None)
time_in_force (default = “day”)
take_profit_price (default = None),
stop_loss_price (default = None),
stop_loss_limit_price (default = None),
trail_price (default = None),
trail_percent (default = None),
position_filled (default = None),
exhange (default = “SMART”)
Return type: order</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">Strategy</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_trading_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Buy 100 shares of SPY</span>
    <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_order</span><span class="p">(</span><span class="s2">"SPY"</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">"buy"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">submit_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<p>For a limit order:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">Strategy</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_trading_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Buy 100 shares of SPY</span>
    <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_order</span><span class="p">(</span><span class="s2">"SPY"</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">"buy"</span><span class="p">,</span> <span class="n">limit_price</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">submit_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>self.submit_order()</strong></p>
<p>Submit an order. Returns the processed order.</p>
<p>Parameters:</p>
<p>order (order): the order object
Return type: order</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">Strategy</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Sell 100 shares of TLT</span>
    <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_order</span><span class="p">(</span><span class="s2">"TLT"</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">"sell"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">submit_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>self.submit_orders()</strong></p>
<p>Submit a list of orders</p>
<p>Parameters:</p>
<p>orders (list(order)): the list of orders
Return type: list(order)</p>
<p><strong>self.wait_for_order_registration()</strong></p>
<p>Wait for the order to be registered by the broker</p>
<p>Parameters:</p>
<p>order (order): the order object
Return type: None</p>
<p><strong>self.wait_for_order_execution()</strong></p>
<p>Wait for the order to execute/be canceled</p>
<p>Parameters:</p>
<p>order (order): the order object
Return type: None</p>
<p><strong>self.wait_for_orders_registration()</strong></p>
<p>Wait for the orders to be registered by the broker</p>
<p>Parameters:</p>
<p>orders (list(order)): the list of orders
Return type: None</p>
<p><strong>self.wait_for_orders_execution()</strong></p>
<p>Wait for the orders to execute/be canceled</p>
<p>Parameters:</p>
<p>orders (list(order)): the list of orders
Return type: None</p>
<p><strong>self.cancel_order()</strong></p>
<p>Cancel an order.</p>
<p>Parameters:</p>
<p>order (order): the order to cancel
Return type: None</p>
<p><strong>self.cancel_orders()</strong></p>
<p>Cancel a list of orders</p>
<p>Parameters:</p>
<p>orders (list(order)): the list of orders to cancel
Return type: None</p>
<p><strong>self.cancel_open_orders()</strong></p>
<p>Cancel all the strategy open orders</p>
<p>Return type: None</p>
<p><strong>self.sell_all()</strong></p>
<p>Sell all strategy current positions</p>
<p>Return type: None</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyStrategy</span><span class="p">(</span><span class="n">Strategy</span><span class="p">):</span>
    <span class="c1"># Will sell all shares that the strategy is tracking on Ctrl + C</span>
    <span class="k">def</span> <span class="nf">on_abrupt_closing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sell_all</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>self.get_last_price()</strong></p>
<p>Return the last known price for a given symbol</p>
<p>Parameters:</p>
<p>symbol (str/asset): the string representation of the asset/share
Return type: float</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">symbol</span> <span class="o">=</span> <span class="s2">"SPY"</span>
<span class="n">current_price</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_price</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The current price of </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">current_price</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>self.get_last_prices()</strong></p>
<p>Return the last known prices for a list symbols</p>
<p>Parameters:</p>
<p>symbols (list(str/asset)): list of share/asset representations
Return type: dict of str:float or asset:asset object</p>
<p><strong>self.get_tradable_assets()</strong></p>
<p>Return the list of tradable assets for the used broker
Return type: list(str/asset)</p>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p><strong>self.get_chains()</strong></p>
<p>For a given symbol/asset, returns the full options chain for all exchanges.
Parameters: symbol/asset
Return type: Dictionary with exchanges as keys, chain dictionary as value.</p>
<p><strong>self.get_chain()</strong></p>
<p>Returns an option chain for one symbol on one exchange.
Parameters: chains, exchange=’SMART’
Returns: Dictionary with:</p>
<p>Underlying_conid: Contract ID with Interactive Brokers.
TradingClass: Stock symbol
Multiplier: Option leverage multiplier.
Expiration: Set of expiration dates. Format ‘YYYYMMDD’
Strikes: Set of strike prices.
get_expiration
Retrieves all of the expiration dates for an option chain, sorted by date.
Parameters: chains, exchange=’SMART’
Returns: list of expirations date in the format “YYYYMMDD”</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">asset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_asset</span><span class="p">(</span><span class="s2">"FB"</span><span class="p">)</span>
<span class="n">chains</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chains</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span>
<span class="n">chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_chain</span><span class="p">(</span><span class="n">chains</span><span class="p">)</span>
<span class="n">expiration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_expiration</span><span class="p">(</span><span class="n">chains</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>self.get_greeks()</strong></p>
<p>Returns the greeks for the option asset at the current bar.</p>
<p>Will return all the greeks available unless any of the individual greeks are selected, then will only return those greeks.</p>
<p>To return all of the greeks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mygreeks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_greeks</span><span class="p">(</span><span class="n">asset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mygreeks</span><span class="p">)</span>
<span class="p">{</span>
    <span class="s1">'implied_volatility'</span><span class="p">:</span> <span class="mf">0.43082467998525587</span><span class="p">,</span>
    <span class="s1">'delta'</span><span class="p">:</span> <span class="mf">0.4261267500109485</span><span class="p">,</span>
    <span class="s1">'option_price'</span><span class="p">:</span> <span class="mf">1.5367826121627828</span><span class="p">,</span>
    <span class="s1">'pv_dividend'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">'gamma'</span><span class="p">:</span> <span class="mf">0.07865783808317735</span><span class="p">,</span>
    <span class="s1">'vega'</span><span class="p">:</span> <span class="mf">0.04556740333269094</span><span class="p">,</span>
    <span class="s1">'theta'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.44406813241266924</span><span class="p">,</span>
    <span class="s1">'underlying_price'</span><span class="p">:</span> <span class="mf">148.98</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that pv_dividend is only available in live testing.
To return only specific greeks, set them as True when calling the function..</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mygreeks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_greeks</span><span class="p">(</span><span class="n">asset</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mygreeks</span><span class="p">)</span>

<span class="c1"># {'delta': 0.4192703569137862, 'theta': -0.44151812979314764}</span>
</pre></div>
</div>
<p><strong>Parameters</strong></p>
<p>Required</p>
<dl class="simple">
<dt>asset: Asset</dt><dd><p>Option asset only for with greeks are desired.</p>
</dd>
</dl>
<p>Optional</p>
<dl class="simple">
<dt>implied_volatility<span class="classifier">boolean</span></dt><dd><p>True to get the implied volatility. (default: True)</p>
</dd>
<dt>delta: boolean</dt><dd><p>True to get the option delta value. (default: True)</p>
</dd>
<dt>option_price: boolean</dt><dd><p>True to get the option price. (default: True)</p>
</dd>
<dt>pv_dividend: boolean</dt><dd><p>True to get the present value of dividends expected on the option’s underlying. (default: True)</p>
</dd>
<dt>gamma: boolean</dt><dd><p>True to get the option gamma value. (default: True)</p>
</dd>
<dt>vega: boolean</dt><dd><p>True to get the option vega value. (default: True)</p>
</dd>
<dt>theta: boolean</dt><dd><p>True to get the option theta value. (default: True)</p>
</dd>
<dt>underlying_price: boolean</dt><dd><p>True to get the price of the underlying. (default: True)</p>
</dd>
</dl>
<p><strong>Returns</strong></p>
<p>Returns a dictionary with greeks as keys and greek values as values.</p>
<dl class="simple">
<dt>implied_volatility: float</dt><dd><p>The implied volatility.</p>
</dd>
<dt>delta: float</dt><dd><p>The option delta value.</p>
</dd>
<dt>option_price: float</dt><dd><p>The option price.</p>
</dd>
<dt>pv_dividend: float</dt><dd><p>The present value of dividends expected on the option’s underlying.</p>
</dd>
<dt>gamma: float</dt><dd><p>The option gamma value.</p>
</dd>
<dt>vega: float</dt><dd><p>The option vega value.</p>
</dd>
<dt>theta: float</dt><dd><p>The option theta value.</p>
</dd>
<dt>underlying_price: float</dt><dd><p>The price of the underlying.</p>
</dd>
</dl>
<p><strong>self.get_datetime()</strong></p>
<p>Return the current datetime localized the datasource timezone e.g. America/New_York. During backtesting this will be the time that the strategy thinks that it is.</p>
<p>Return type: datetime</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The current time is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_datetime</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>self.get_timestamp()</strong></p>
<p>Return the current UNIX timestamp. During backtesting this will be the UNIX timestamp that the strategy thinks that it is.</p>
<p>Return type: float</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The current time is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_timestamp</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>self.get_round_minute()</strong></p>
<p>Returns a minute rounded datetime object.</p>
<p>Optional Parameters:</p>
<p>timeshift (int): a timeshift in minutes from the present.
Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Return a midnight rounded datetime object of three minutes ago</span>
<span class="n">dt</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_round_minute</span><span class="p">(</span><span class="n">timeshift</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="c1"># datetime.datetime(2021, 2, 21, 9, 17, tzinfo=&lt;DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD&gt;)</span>
</pre></div>
</div>
<p>Return type: datetime</p>
<p><strong>self.get_last_minute()</strong></p>
<p>Returns the last minute rounded datetime object. Shortcut to straregy.get_round_minute(timeshift=1)</p>
<p>Return type datetime.</p>
<p><strong>self.get_round_day()</strong></p>
<p>Returns a day rounded datetime object.</p>
<p>Optional Parameters:</p>
<p>timeshift (int): a timeshift in days from the present.
Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Return a midnight rounded datetime object of three days ago</span>
<span class="n">dt</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_round_day</span><span class="p">(</span><span class="n">timeshift</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="c1"># datetime.datetime(2021, 2, 21, 0, 0, tzinfo=&lt;DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD&gt;)</span>
</pre></div>
</div>
<p>Return type datetime</p>
<p><strong>self.get_last_day()</strong></p>
<p>Returns the last day rounded datetime object. Shortcut to straregy.get_round_day(timeshift=1)</p>
<p>Return type datetime.</p>
<p><strong>self.get_datetime_range()</strong></p>
<p>Takes as input length, timestep and timeshift and returns a tuple of datetime representing the start date and end date.</p>
<p>Parameters:</p>
<p>length (int): represents the number of bars required
timestep (str): represents the timestep, either minute (default value) or day.
timeshift (timedelta): None by default. If specified indicates the time shift from the present.
Return type datetime</p>
<p><strong>self.localize_datetime()</strong></p>
<p>Converts an unaware datetime object (datetime object without a timezone) to an aware datetime object. The default timezone is America/New_York.</p>
<p>Parameter:</p>
<p>dt (datetime): the datetime object to convert.
Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">dt</span> <span class="o">=</span>  <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="c1"># datetime.datetime(2021, 2, 21, 0, 0)</span>
<span class="n">dt_aware</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">localize_datetime</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt_aware</span><span class="p">)</span>
<span class="c1"># datetime.datetime(2021, 2, 21, 0, 0, tzinfo=&lt;DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD&gt;)</span>
</pre></div>
</div>
<p>Return type: datetime</p>
<p><strong>self.to_default_timezone()</strong></p>
<p>Transpose an aware datetime object to the default timezone America/New_York.</p>
<p>Parameter:</p>
<p>dt (datetime): the datetime object to convert.
Return type: datetime</p>
<p><strong>self.get_symbol_bars()</strong></p>
<p>Return bars for a given symbol.</p>
<p>Parameters:</p>
<p>symbol (str/asset): The symbol string representation (e.g AAPL, GOOG, …) or asset object.
length (int): The number of rows (number of timestamps)
timestep (str): Either “minute”” for minutes data or “day”” for days data default value depends on the data_source (minute for alpaca, day for yahoo, …)
timeshift (timedelta): None by default. If specified indicates the time shift from the present.
Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>

<span class="c1"># Extract 10 rows of SPY data with one minute timestep between each row</span>
<span class="c1"># with the latest data being 24h ago (timedelta(days=1))</span>
<span class="n">bars</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_symbol_bars</span><span class="p">(</span><span class="s2">"SPY"</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="s2">"minute"</span><span class="p">,</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">Return</span> <span class="nb">type</span><span class="p">:</span> <span class="n">bars</span>
</pre></div>
</div>
<p><strong>self.get_bars()</strong></p>
<p>Return a dictionary of bars for a given list of symbols. Works the same as get_symbol_bars but take as first parameter a list of symbols.</p>
<p>Parameters:</p>
<p>symbol (list(str/asset)): The symbol string representation (e.g AAPL, GOOG, …) or asset object.
length (int): The number of rows (number of timestamps)
timestep (str): Either “minute”” for minutes data or “day”” for days data default value depends on the data_source (minute for alpaca, day for yahoo, …)
timeshift (timedelta): None by default. If specified indicates the time shift from the present.
Return type: dict of str/asset:bars</p>
<p><strong>self.start_realtime_bars()</strong></p>
<p>Starts a real time stream of tickers for Interactive Broker only.</p>
<p>This allows for real time data to stream to the strategy. Bars are fixed at every five seconds. They will arrive in the strategy in the form of a dataframe. The data returned will be:</p>
<p>datetime
open
high
low
close
volume
vwap
count (trade count)
Parameters:
asset : Asset object The asset to stream data.</p>
<p>keep_bars : int How many bars/rows to keep of data. If running for an extended period of time, it may be desirable to limit the size of the data kept.</p>
<p>Returns:
None</p>
<p><strong>self.get_realtime_bars()</strong></p>
<p>Retrieve the real time bars as dataframe.</p>
<p>Returns the current set of real time bars as a dataframe. The datetime will be in the index. Time intervals will be set at 5 secs. The columns of the dataframe are:</p>
<p>open
high
low
close
volume
vwap
count (trade count)
Parameters:
asset : Asset object The asset that has a stream active.</p>
<p>Returns:
dataframe : Pandas Dataframe.
Dataframe containing the most recent pricing information for the asset. The data returned will be the datetime in the index and the following columns.</p>
<p>open
high
low
close
volume
vwap
count (trade count)
The length of the dataframe will have been set the initial start of the real time bars.</p>
<p><strong>self.cancel_realtime_bars()</strong></p>
<p>Cancels a stream of real time bars for a given asset.</p>
<p>Cancels the real time bars for the given asset.</p>
<p>Parameters:
asset : Asset object
Asset object that has streaming data to cancel.</p>
<p>Returns:
None</p>
<p><strong>self.get_yesterday_dividend()</strong></p>
<p>Return dividend per share for the day before for a given symbol</p>
<p>Parameters:</p>
<p>symbol (str/asset): The symbol string representation (e.g AAPL, GOOG, …) or asset object.
Return type: float or asset object</p>
<p><strong>self.get_yesterday_dividends()</strong></p>
<p>Return dividend per share for the day before for a given list of symbols. Works the same as get_yesterday_dividend but take as parameter a list of symbols.</p>
<p>Parameters:</p>
<p>symbol (str/asset): The symbol string representation (e.g AAPL, GOOG, …) or asset object.
Return type: dict of str:float</p>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Lumiwealth |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="_sources/strategy_methods_old.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Strategy Methods</a><ul>
<li><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    </body>
</html>